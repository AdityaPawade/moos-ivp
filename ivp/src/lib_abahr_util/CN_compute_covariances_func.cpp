// compute covariances of position estimate for range circle intersection for a given set
//
// INPUT ARGUMENTS:
//
//   G: covariance matrix [x11 y11 x22 y22 r11 r22 dx dy]' * [x11 y11 x22 y22 r11 r22 dx dy]
//   sol: 2x2 solution matrix with 0 if the solution is valid and 1 if the solution is not valid
//
// MODIFIED INPUT ARGUMENTS:
//
//   sigma_xy: a 2 element array with each element containing a 2 by 2 matrix for the position covariances
//
// HISTORY:
// ----------------------------------------------------------------------------------------------------------------------
// 9/8/2005        abahr       created

#include "CN.h"

void CN_compute_covariances_func(double x11,double y11,double x22,double y22,double r11,double r22,double dx,double dy,gsl_matrix *G,gsl_matrix *sol,gsl_matrix *sigma_xy[2])
{ 
	// allocate Jacobian and its transpose
	double J[2][2][2][8];
	gsl_matrix *J_select = gsl_matrix_calloc(2,8);
	gsl_matrix *J_select_t = gsl_matrix_calloc(8,2);
		
	J[0][0][0][0] = 1/2-1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22)+1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dx-2*x11+2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22)*pow((dy+y11-y22),2))-1/2*
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22);
	
	J[0][0][0][1] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22)+1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dy-2*y11+2*y22)*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22)*pow((dy+y11-y22),2)+2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*(dy+y11-y22))-1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22);
	
	J[0][0][0][2] = 1/2+1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dx-2*x11+2*x22)+1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((2*dx+2*x11-2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*dx-2*x11+2*x22)*pow((dy+y11-y22),2))-1/
	2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dx-2*x11+2*x22);
	
	J[0][0][0][3] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dy-2*y11+2*y22)+1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((2*dy+2*y11-2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*dy-2*y11+2*y22)*
	pow((dy+y11-y22),2)-2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*(dy+y11-y22))-1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*
	(-2*dy-2*y11+2*y22);
	
	J[0][0][0][4] = -1/2*(r11+r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/2*(r11-r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((2*r11-2*r22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*r11-2*r22)*pow((dy+y11-y22),2));
	
	J[0][0][0][5] = 1/2*(r11+r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/2*(r11-r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*r11+2*r22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*r11-2*r22)*pow((dy+y11-y22),2));
	
	J[0][0][0][6] = 1/2-1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22)+1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*
	((-2*dx-2*x11+2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22)*pow((dy+y11-y22),2))-1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*
	(2*dx+2*x11-2*x22);
	
	J[0][0][0][7] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22)+1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dy-2*y11+2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22)*
	pow((dy+y11-y22),2)+2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*(dy+y11-y22))-1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*
	(2*dy+2*y11-2*y22);
	
    J[0][0][1][0] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dx+4*x11-4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(2*dx+2*x11-2*x22)+1/2/pow((-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*
    (-2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(2*dx+2*x11-2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22))+(2*dx+2*x11-2*x22)*y22);
    
    J[0][0][1][1] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dy+4*y11-4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2)+
    (dy+y11)*(2*dy+2*y11)+1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+
    (dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(2*dy+2*y11-2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22))+(-2*dy-2*y11)*
    y22-pow(y22,2)), 
    
    J[0][0][1][2] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (-4*dx-4*x11+4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(-2*dx-2*x11+2*x22)+1/2/pow((-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*
    (2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(-2*dx-2*x11+2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*dx-2*x11+2*x22))+(-2*dx-2*x11+2*x22)*y22);
    
    J[0][0][1][3] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (-4*dy-4*y11+4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(-2*dy-2*y11+2*y22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*dy-2*y11+2*y22))+pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2)-2*(dy+y11)*y22+3*pow(y22,2));
    
    J[0][0][1][4] = 1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-2*(dy+y11)*r11+1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(-2*r11+2*r22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*r11-2*r22))+2*r11*y22);
     
    J[0][0][1][5] = 1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(2*(dy+y11)*r22+1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(2*r11-2*r22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*r11-2*r22))-2*r22*y22);
    
    J[0][0][1][6] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dx+4*x11-4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(2*dx+2*x11-2*x22)+1/2/pow((-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*
    (-2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(2*dx+2*x11-2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22))+(2*dx+2*x11-2*x22)*y22);
    
    J[0][0][1][7] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dy+4*y11-4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2)+(dy+y11)*
    (2*dy+2*y11)+1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(2*dy+2*y11-2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22))+(-2*dy-2*y11)*
    y22-pow(y22,2));
 
	J[0][1][0][0] = 1/2-1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22)+1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*
	((-2*dx-2*x11+2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*	(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22)*pow((dy+y11-y22),2))-1/2*
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22);
	
	J[0][1][0][1] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22)+1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dy-2*y11+2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22)*
	pow((dy+y11-y22),2)+2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*(dy+y11-y22))-1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*
	(2*dy+2*y11-2*y22);
	
	J[0][1][0][2] = 1/2+1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dx-2*x11+2*x22)+1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*
	((2*dx+2*x11-2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(-2*dx-2*x11+2*x22)*pow((dy+y11-y22),2))-1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*
	(-2*dx-2*x11+2*x22);
	
	J[0][1][0][3] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dy-2*y11+2*y22)+1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((2*dy+2*y11-2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*dy-2*y11+2*y22)*
	pow((dy+y11-y22),2)-2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*(dy+y11-y22))-1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*
	(-2*dy-2*y11+2*y22);
	
	J[0][1][0][4] = -1/2*(r11+r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/2*(r11-r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((2*r11-2*r22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*r11-2*r22)*pow((dy+y11-y22),2));
	                                                                                                                                                                                                                                                                                                                                                                                                                      
	J[0][1][0][5] = 1/2*(r11+r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/2*(r11-r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*r11+2*r22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*r11-2*r22)*pow((dy+y11-y22),2));
	 
	J[0][1][0][6] = 1/2-1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+
	pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22)+1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*
	((-2*dx-2*x11+2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-
	(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22)*pow((dy+y11-y22),2))-1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+
	pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22);
	
	J[0][1][0][7] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22)+1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dy-2*y11+2*y22)*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22)*pow((dy+y11-y22),2)+2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*(dy+y11-y22))-1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22);
    
    J[0][1][1][0] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))-
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dx+4*x11-4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(2*dx+2*x11-2*x22)-1/2/pow((-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*
    (-2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(2*dx+2*x11-2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22))+(2*dx+2*x11-2*x22)*y22);
    
    J[0][1][1][1] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))-
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dy+4*y11-4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2)+(dy+y11)*
    (2*dy+2*y11)-1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(2*dy+2*y11-2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22))+(-2*dy-2*y11)*
    y22-pow(y22,2));
    
    J[0][1][1][2] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))-
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (-4*dx-4*x11+4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(-2*dx-2*x11+2*x22)-1/2/pow((-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*
    (2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(-2*dx-2*x11+2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*dx-2*x11+2*x22))+(-2*dx-2*x11+2*x22)*y22);
    
    J[0][1][1][3] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))-
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (-4*dy-4*y11+4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(-2*dy-2*y11+2*y22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*dy-2*y11+2*y22))+pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2)-2*(dy+y11)*y22+3*pow(y22,2));
    
    J[0][1][1][4] = 1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-2*(dy+y11)*r11-1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+
    (dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*
    (-2*r11+2*r22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*r11-2*r22))+2*r11*y22);
    
    J[0][1][1][5] = 1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(2*(dy+y11)*r22-1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+
    (dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*
    (2*r11-2*r22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*r11-2*r22))-2*r22*y22);
    
    J[0][1][1][6] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+
    pow((dy+y11),2))-pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+
    (dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*
    pow(y22,2)+pow(y22,3))*(4*dx+4*x11-4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(2*dx+2*x11-2*x22)-1/2/
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))*(-2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(2*dx+2*x11-2*x22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22))+(2*dx+2*x11-2*x22)*y22);
    
    J[0][1][1][7] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+
    pow((dy+y11),2))-pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+
    (dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*
    pow(y22,2)+pow(y22,3))*(4*dy+4*y11-4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+
    pow((dy+y11),2)+(dy+y11)*(2*dy+2*y11)-1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(2*dy+2*y11-2*y22)*(pow((dx+x11-x22),2)+
    (dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (2*dy+2*y11-2*y22))+(-2*dy-2*y11)*y22-pow(y22,2));

	J[1][0][0][0] = 1/2-1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22)-1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dx-2*x11+2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22)*pow((dy+y11-y22),2))+1/2*
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22);
	
	J[1][0][0][1] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22)-1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dy-2*y11+2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22)*
	pow((dy+y11-y22),2)+2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*(dy+y11-y22))+1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+
	pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22);
	 
	J[1][0][0][2] = 1/2+1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dx-2*x11+2*x22)-1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((2*dx+2*x11-2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*dx-2*x11+2*x22)*pow((dy+y11-y22),2))+1/2*
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dx-2*x11+2*x22);
	 
	J[1][0][0][3] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dy-2*y11+2*y22)-1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((2*dy+2*y11-2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*dy-2*y11+2*y22)*
	pow((dy+y11-y22),2)-2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*(dy+y11-y22))+1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dy-2*y11+2*y22);
	 
	J[1][0][0][4] = -1/2*(r11+r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/2*(r11-r22)*(dx+x11-x22)/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*
	((2*r11-2*r22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*r11-2*r22)*pow((dy+y11-y22),2));
	 
	J[1][0][0][5] = 1/2*(r11+r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/2*(r11-r22)*(dx+x11-x22)/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*
	((-2*r11+2*r22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*r11-2*r22)*pow((dy+y11-y22),2));
	
	J[1][0][0][6] = 1/2-1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22)-1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dx-2*x11+2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22)*pow((dy+y11-y22),2))+1/2*
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22);
	
	J[1][0][0][7] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22)-1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dy-2*y11+2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22)*
	pow((dy+y11-y22),2)+2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*(dy+y11-y22))+1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22);
	 
    J[1][0][1][0] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dx+4*x11-4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(2*dx+2*x11-2*x22)+1/2/pow((-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))*(-2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(2*dx+2*x11-2*x22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22))+(2*dx+2*x11-2*x22)*y22);
     
    J[1][0][1][1] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dy+4*y11-4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2)+
    (dy+y11)*(2*dy+2*y11)+1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(2*dy+2*y11-2*y22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22))+(-2*dy-2*y11)*y22-pow(y22,2));
    
    J[1][0][1][2] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (-4*dx-4*x11+4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(-2*dx-2*x11+2*x22)+1/2/pow((-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))*(2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(-2*dx-2*x11+2*x22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*dx-2*x11+2*x22))+(-2*dx-2*x11+2*x22)*y22);
    
    J[1][0][1][3] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (-4*dy-4*y11+4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+
    (dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*
    (-pow((dx+x11-x22),2)*(-2*dy-2*y11+2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*dy-2*y11+2*y22))+pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-
    pow((dy+y11),2)-2*(dy+y11)*y22+3*pow(y22,2));
     
    J[1][0][1][4] = 1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-2*(dy+y11)*r11+1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(-2*r11+2*r22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*r11-2*r22))+2*r11*y22);
     
    J[1][0][1][5] = 1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(2*(dy+y11)*r22+1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(2*r11-2*r22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*r11-2*r22))-2*r22*y22);
     
    J[1][0][1][6] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dx+4*x11-4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(2*dx+2*x11-2*x22)+1/2/pow((-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))*(-2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(2*dx+2*x11-2*x22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22))+(2*dx+2*x11-2*x22)*y22);
     
    J[1][0][1][7] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))+
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dy+4*y11-4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2)+
    (dy+y11)*(2*dy+2*y11)+1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(2*dy+2*y11-2*y22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22))+(-2*dy-2*y11)*y22-pow(y22,2));

	J[1][1][0][0] = 1/2-1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22)-1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dx-2*x11+2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22)*pow((dy+y11-y22),2))+1/2*
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22);
	
	J[1][1][0][1] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22)-1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dy-2*y11+2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22)*
	pow((dy+y11-y22),2)+2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*(dy+y11-y22))+1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22);
	
	J[1][1][0][2] = 1/2+1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dx-2*x11+2*x22)-1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((2*dx+2*x11-2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*dx-2*x11+2*x22)*pow((dy+y11-y22),2))+1/2*
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dx-2*x11+2*x22);
	
	J[1][1][0][3] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dy-2*y11+2*y22)-1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((2*dy+2*y11-2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*dy-2*y11+2*y22)*
	pow((dy+y11-y22),2)-2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*(dy+y11-y22))+1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(-2*dy-2*y11+2*y22);
	
	J[1][1][0][4] = -1/2*(r11+r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/2*(r11-r22)*(dx+x11-x22)/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*
	((2*r11-2*r22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*r11-2*r22)*pow((dy+y11-y22),2));
	
	J[1][1][0][5] = 1/2*(r11+r22)*(dx+x11-x22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/2*(r11-r22)*(dx+x11-x22)/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))-1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*
	((-2*r11+2*r22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-
	(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(-2*r11-2*r22)*pow((dy+y11-y22),2));
	
	J[1][1][0][6] = 1/2-1/2*(r11-r22)*(r11+r22)/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))+1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22)-1/4/pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dx-2*x11+2*x22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22)*pow((dy+y11-y22),2))+1/2*
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*
	pow((dy+y11-y22),2)),(1/2))/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dx+2*x11-2*x22);
	
	J[1][1][0][7] = 1/2*(r11-r22)*(r11+r22)*(dx+x11-x22)/pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22)-1/4/
	pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/(pow((dx+x11-x22),2)+pow((dy+y11-y22),2))*((-2*dy-2*y11+2*y22)*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)+(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22)*pow((dy+y11-y22),2)+2*(-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*(dy+y11-y22))+1/2*pow(((-pow((dx+x11-x22),2)-(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))*pow((dy+y11-y22),2)),(1/2))/
	pow((pow((dx+x11-x22),2)+pow((dy+y11-y22),2)),2)*(2*dy+2*y11-2*y22);
	
	J[1][1][1][0] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))-
	pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
	(4*dx+4*x11-4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(2*dx+2*x11-2*x22)-1/2/pow((-pow((dx+x11-x22),2)*
	(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
	(dy+r11+r22+y11-y22))),(1/2))*(-2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(2*dx+2*x11-2*x22)*
	(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
	(dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22))+(2*dx+2*x11-2*x22)*y22);

    J[1][1][1][1] =  -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))-
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dy+4*y11-4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2)+
    (dy+y11)*(2*dy+2*y11)-1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(2*dy+2*y11-2*y22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22))+(-2*dy-2*y11)*y22-pow(y22,2));
     
    J[1][1][1][2] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))-
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (-4*dx-4*x11+4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(-2*dx-2*x11+2*x22)-1/2/pow((-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))*(2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(-2*dx-2*x11+2*x22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*dx-2*x11+2*x22))+(-2*dx-2*x11+2*x22)*y22);
     
    J[1][1][1][3] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))-
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (-4*dy-4*y11+4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-1/2/pow((-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(-2*dy-2*y11+2*y22)*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (-2*dy-2*y11+2*y22))+pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2)-2*(dy+y11)*y22+3*pow(y22,2));
     
    J[1][1][1][4] = 1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-2*(dy+y11)*r11-1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(-2*r11+2*r22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*r11-2*r22))+2*r11*y22);
     
    J[1][1][1][5] = 1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(2*(dy+y11)*r22-1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(2*r11-2*r22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(-2*r11-2*r22))-2*r22*y22);
    
    J[1][1][1][6] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))-
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dx+4*x11-4*x22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*((dy+y11)*(2*dx+2*x11-2*x22)-1/2/pow((-pow((dx+x11-x22),2)*
    (pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))*(-2*(dx+x11-x22)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(2*dx+2*x11-2*x22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(2*dx+2*x11-2*x22))+(2*dx+2*x11-2*x22)*y22);
    
    J[1][1][1][7] = -1/pow((2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2)),2)*((dy+y11)*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2))-
    pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*(pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*
    (dy+r11+r22+y11-y22))),(1/2))+(pow(r11,2)-pow(r22,2)+pow((dx+x11-x22),2)-pow((dy+y11),2))*y22-(dy+y11)*pow(y22,2)+pow(y22,3))*
    (4*dy+4*y11-4*y22)+1/(2*pow((dx+x11-x22),2)+2*pow((dy+y11-y22),2))*(-pow(r11,2)+pow(r22,2)+pow((dx+x11-x22),2)+pow((dy+y11),2)+
    (dy+y11)*(2*dy+2*y11)-1/2/pow((-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*(dy-r11+r22+y11-y22))*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))),(1/2))*(-pow((dx+x11-x22),2)*(2*dy+2*y11-2*y22)*
    (pow((dx+x11-x22),2)+(dy-r11-r22+y11-y22)*(dy+r11+r22+y11-y22))-pow((dx+x11-x22),2)*(pow((dx+x11-x22),2)+(dy+r11-r22+y11-y22)*
    (dy-r11+r22+y11-y22))*(2*dy+2*y11-2*y22))+(-2*dy-2*y11)*y22-pow(y22,2));
  
	int j=0;
	int k,l,n,m;
	
	for(n=1;n<=2;n++)
	{
	    for(m=1;m<=2;m++)
	    {
	        if(gsl_matrix_get(sol,n,m)==1)
	        {
	            for(k=0;k<=1;k++)
	            {
	            	for(l=0;l<=7;l++)
	            	{
	            		gsl_matrix_set(J_select,k,l,J[n][m][k][l]);
	            	}
	            }
            	// compute transpose
            	gsl_matrix_transpose_memcpy(J_select_t,J_select);
        	    
        	    // MATLAB code: sigma_xy{j}=J_select*G*J_select';
        	    gsl_matrix_memcpy(sigma_xy[j],J_select);
        	    gsl_matrix_mul_elements(sigma_xy[j],G);
        	    gsl_matrix_mul_elements(sigma_xy[j],J_select_t);
            	j=j+1;
	        }
	    }
	}
	
	// free local matrices
	gsl_matrix_free(J_select);
	gsl_matrix_free(J_select_t);
}
